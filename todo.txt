На чем остановился:
	Заказы создаются. Реализована проверка заказов. Нужно помимо базы обновлять статус пользователя в Redis!!!

Бэкап базы данных
удаление заказов через сутки
очистка заказов спустя 180 дней
удаление настроек пользователя через 180 дней


1. /start - главная страница, на которой проверяется, создан ли пользлователь в базе данных.
	Если пользователь новый, то он создается в БД и присваивается статус created ему выводится клавиатура:
	- /activate_trial - активировать пробный период на 3 дня
	- /extend_sub - продлить подписку
	- /get_discount - активировать промокод
	Если статус пользователя trial,executed,paid,outdated ему выводится срок окончания подписки, приветствие
и клавиатура:
	- /get_settings - получить настройки
	- /get_discount - активировать промокод (кнопка есть в случае если user.status != paid,expired,outdated)
	- /get_promocode - получить свой промокод для скидки (кнопка есть в случае если user.status = paid,expired,outdated)
	- /extend_sub - продлить подписку
	- /instruction - инструкция
	- /orders - заказы пользователя

	Если статус пользователя expired, пользователю выводится сообщение об окончании подписки
	
2. /get_settings - если пользователь в статусе trial,outdated пользователю присваивается статус pending и далее в постоянных
операциях данный статус мониторится и создаются настройки.
	Если статус пользователя expired, пользователю выводится сообщение об окончании подписки.
	Во всех остальных статусах настройки высылаются в виде файла конфига и QR кода.

3. /get_discount - пользователь вводит промокод, происходит проверка, есть ли промокод в БД в поле user.promocode
Если есть, и статус пользователя trial или created то пользователю проставляется скидка в поле user.discount 300р, ставиться галка в поле promocode_discount
(что значит что текущая скидка сделана после применения промокода) и в поле user.invite_user_id проставляется id пользователя
чей промокод был применен. Пользователя возвращает в /main
	Если промокод не существует предлагается ввести промокод еще раз (/get_discount) или вернуться на главную (/main)

4. /extend_sub - продление подписки. Переводит в меню /sub_plans
5. /main - перевод на главную страницу, на которой указан срок действия подписки, скидка и основные пункты меню.
Клавиатура как на кнопке /start
6. /sub_plans - вывод пользователю списка из существующих тарифов. Если у пользователя есть скидка, она указывается 
в сообщении.
	Клавиатура:
	- /plan_id - кнопка с тарифами и ценник с учетом скидки
	- /main - вернуться на главную страницу

7. /plan_id - создается заказ. Из выбранного тарифа вытаскивается сумма и количество дней подписки. Если есть user.discount, то от стоимость тарифа отнимается скидка. Если user.promocode_discount,
то значит это первый заказ после ввода промокода, поэтому ставим галочку invite_order. В будущем при проверке оплаты заказа это позволит
проставить скидку тому, кто дал промокод.

8. /orders - вывод на экран всех заказов пользователя с возможностью перейти на страницу оплаты.
9. /instruction - вывод инструкции по установке VPN
10. Бизнес-логика.
	10.1 Создание настроек.
	Раз в 4 минуты происходит опрос БД на предмет пользователей в статусе pending. Если такие пользователи обнаружены, то
	для каждого пользователя в этом статусе выполняется:
		- поиск сервера с загрузкой по пользователям менее 15 чел.
		- выбор IP исходя из выбранного сервера
		- генерация ключей и создание записи в таблице VPN
		- генерация конфига и QR кода
		- отправка настроек пользователю
	Если были новые пользователи, происходит синхронизация настроек серверов.
	
	10.2 Проверка ожидающих счетов
	Раз в 5 минут происходит опрос БД на предмет счетов, которые ожидают оплаты. Если они есть, то для каждого такого счета
	выполняется:
		- проверка оплаты данного счета
		- если счет оплачен:
			- меняется статус счета
			- меняется статус пользователя, чей был счет
			- прибавляется количество дней к подписке
			- проверка был ли счет пригласительным. Если был, то тому кто пригласил проставляется скидка 100
		- если не оплачен:
			- проверяется не протух ли счет. Счет действителен 3 дня. если счет протух он помечается как удаленный.
			
	10.3 Проверка истечения срока подписки.
	Раз в сутки происходит проверка истечения срока подписки пользователей. Если менее 7,1 дней высылается уведомление.
	Если срок истек меняется статус пользователя на expired и высылается уведомление.
	Если срок истек более полугода назад, высылается уведомление что если подписка не будет продлена, аккаунт будет удален
	через 14 дней.
	Если истек более 194 дней назад статус меняется на outdated, удаляется vpn, меняется количество пользователей на сервере,
	удаляеется файл и qr код конфига. 
	
	
	10.4 Ребилд конфига серверов.
	Раз в сутки ребилд конфига серверов, удаление пользователей. 
	


Поля user:
- id
- telegram_id
- name
- status
- promocode
- discount
- promocode_discount (bool)
- user.invite_user_id - кто пригласил пользователя
- created_at
- updated_at
- expires_at

Статусы user:
- created - пользователь только что создан
- trial - присваивается при активации пробного периода
- paid - оплачен
- expired - подписка окончена
- outdated - настройки удалены


Поля order:
- id
- user_id
- status
- donate_url
- days
- amount
- invite_order (bool)
- deleted (bool)
- created_at
- updated_at

Статусы orders:
- pending - ожидает оплаты
- paid - оплачен 

Поля plan:
- id
- name
- days
- amount

Поля vpn:
- id
- status
- user_id
- server_id
- ip
- public_key
- created_at
- updated_at

Статусы VPN:
- pending - после нажатия кнопки /get_settings
- executed - настройки созданы
- outdated - пользователь не продлевал подписку более полугода.

Поля discount:
- id
- status
- from_user
- to_user

Статусы discount:
- applied - когда to_user ввел промокод
- paid - когда to_user оплатил со скидкой
